openapi: "3.0.0"
info:
  title: Momentor Mentors API
  version: 1.0.0
  description: |
    OpenAPI description for the Momentor Mentors service. This spec documents
    authentication, users, meetings, tasks, MOMs and dashboard endpoints.
servers:
  - url: /
paths:
  /api/auth/login:
    post:
      summary: Authenticate user and return JWT
      tags: [Auth]
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/LoginRequestDto'
            example:
              username: student@example.com
              password: secret123
      responses:
        '200':
          description: Successful login returns token
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/LogInResponseDto'
  /api/auth/createuser:
    post:
      summary: Create a new user
      tags: [Auth]
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UserRequestDto'
            example:
              name: Alice Student
              email: alice@example.com
              password: p@ssword
              role: STUDENT
      responses:
        '200':
          description: Created user
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/UserResponseDto'
  /api/users/getuser:
    get:
      summary: Get all users
      tags: [Users]
      responses:
        '200':
          description: List of users
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/UserResponseDto'
  /api/meetings:
    post:
      summary: Create a meeting (MENTOR)
      tags: [Meetings]
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/MeetingRequestDto'
      responses:
        '200':
          description: Created meeting
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/MeetingResponseDto'
  /api/meetings/{id}/mom:
    post:
      summary: Add MOM to a meeting
      tags: [Meetings]
      parameters:
        - name: id
          in: path
          schema:
            type: integer
          required: true
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/MomRequestDto'
      responses:
        '200':
          description: Created MOM
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/MomResponseDto'
  /api/meetings/progress/meeting/{meetingid}:
    get:
      summary: Get progress percentage for a meeting
      tags: [Meetings]
      parameters:
        - name: meetingid
          in: path
          required: true
          schema:
            type: integer
      responses:
        '200':
          description: progress percent (0.0 - 100.0)
          content:
            application/json:
              schema:
                type: number
                format: double
  /api/meetings/my:
    get:
      summary: Get meetings for authenticated mentor
      tags: [Meetings]
      security:
        - bearerAuth: []
      responses:
        '200':
          description: list of meetings
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/MeetingResponseDto'
  /api/meetings/{meetingId}/mom:
    get:
      summary: Get MOM for a meeting (role-sensitive)
      tags: [Meetings]
      parameters:
        - name: meetingId
          in: path
          required: true
          schema:
            type: integer
      security:
        - bearerAuth: []
      responses:
        '200':
          description: MOM content (may be empty)
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/MomResponseDto'
  /api/meetings/{meetingId}:
    delete:
      summary: Delete a meeting (MENTOR)
      tags: [Meetings]
      parameters:
        - name: meetingId
          in: path
          required: true
          schema:
            type: integer
      security:
        - bearerAuth: []
      responses:
        '200':
          description: deletion result
  /api/tasks/mom/{momid}:
    post:
      summary: Create a task for a MOM
      tags: [Tasks]
      parameters:
        - name: momid
          in: path
          required: true
          schema:
            type: integer
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/TaskRequestDto'
            example:
              title: "Finish assignment"
              assignedTo: student@example.com
      responses:
        '200':
          description: created task
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/TaskResponseDto'
  /api/tasks/{taskid}/status:
    put:
      summary: Update task status
      tags: [Tasks]
      parameters:
        - name: taskid
          in: path
          required: true
          schema:
            type: integer
        - name: status
          in: query
          required: true
          schema:
            type: string
            example: DONE
      responses:
        '200':
          description: updated status
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/TaskStatusResponseDto'
  /api/tasks/progress:
    get:
      summary: Get overall tasks progress percent
      tags: [Tasks]
      responses:
        '200':
          description: percent (0-100)
          content:
            application/json:
              schema:
                type: number
                format: double
  /api/tasks/paged:
    get:
      summary: Get paged tasks
      tags: [Tasks]
      parameters:
        - name: page
          in: query
          schema:
            type: integer
            default: 0
        - name: size
          in: query
          schema:
            type: integer
            default: 5
        - name: sortby
          in: query
          schema:
            type: string
            default: createdat
        - name: direction
          in: query
          schema:
            type: string
            default: desc
      responses:
        '200':
          description: paged tasks (framework specific structure)
  /api/tasks/{taskId}/meeting:
    get:
      summary: Get meeting details for a task (role-sensitive)
      tags: [Tasks]
      parameters:
        - name: taskId
          in: path
          required: true
          schema:
            type: integer
      security:
        - bearerAuth: []
      responses:
        '200':
          description: Meeting with MOM info
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/MeetingWithMomResponseDto'
  /api/tasks:
    get:
      summary: Mentor-only: get mentor tasks
      tags: [Tasks]
      security:
        - bearerAuth: []
      responses:
        '200':
          description: list of tasks for mentor
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/TaskResponseDto'
  /api/tasks/user/{username}:
    get:
      summary: Student-only: get tasks by username
      tags: [Tasks]
      parameters:
        - name: username
          in: path
          required: true
          schema:
            type: string
      security:
        - bearerAuth: []
      responses:
        '200':
          description: list of tasks assigned to user
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/TaskResponseDto'
  /api/tasks/admin/all:
    get:
      summary: Admin-only: get all tasks
      tags: [Tasks]
      security:
        - bearerAuth: []
      responses:
        '200':
          description: all tasks
  /api/tasks/dashboard/summary/mentor:
    get:
      summary: Mentor dashboard summary (MENTOR or ADMIN)
      tags: [Dashboard]
      security:
        - bearerAuth: []
      responses:
        '200':
          description: dashboard summary object
  /api/tasks/dashboard/summary/student:
    get:
      summary: Student dashboard summary (STUDENT or ADMIN)
      tags: [Dashboard]
      security:
        - bearerAuth: []
      responses:
        '200':
          description: dashboard summary object
  /api/tasks/dashboard/summary:
    get:
      summary: Admin dashboard summary (ADMIN)
      tags: [Dashboard]
      security:
        - bearerAuth: []
      responses:
        '200':
          description: dashboard summary object
  /api/dashboard/summary:
    get:
      summary: Global dashboard summary
      tags: [Dashboard]
      responses:
        '200':
          description: aggregated dashboard data
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/DashBoardResponseDto'
components:
  securitySchemes:
    bearerAuth:
      type: http
      scheme: bearer
      bearerFormat: JWT
  schemas:
    LoginRequestDto:
      type: object
      properties:
        username:
          type: string
        password:
          type: string
      required: [username, password]
    LogInResponseDto:
      type: object
      properties:
        token:
          type: string
      example:
        token: eyJhbGciOiJIUzI1NiJ9.exampletoken
    UserRequestDto:
      type: object
      properties:
        name:
          type: string
        email:
          type: string
        password:
          type: string
        role:
          type: string
      required: [name, email, password, role]
    UserResponseDto:
      type: object
      properties:
        id:
          type: integer
        name:
          type: string
        email:
          type: string
        role:
          type: string
      example:
        id: 1
        name: Alice Student
        email: alice@example.com
        role: STUDENT
    MeetingRequestDto:
      type: object
      properties:
        title:
          type: string
        meetingdate:
          type: string
          format: date-time
      required: [title, meetingdate]
    MeetingResponseDto:
      type: object
      properties:
        id:
          type: integer
        title:
          type: string
        meetingdate:
          type: string
          format: date-time
    MomRequestDto:
      type: object
      properties:
        momtext:
          type: string
      required: [momtext]
    MomResponseDto:
      type: object
      properties:
        id:
          type: integer
        momtext:
          type: string
    TaskRequestDto:
      type: object
      properties:
        title:
          type: string
        assignedTo:
          type: string
      required: [title, assignedTo]
    TaskResponseDto:
      type: object
      properties:
        id:
          type: integer
        title:
          type: string
        assignedTo:
          type: string
        status:
          type: string
      example:
        id: 10
        title: "Finish assignment"
        assignedTo: student@example.com
        status: NOT_STARTED
    TaskStatusResponseDto:
      type: object
      properties:
        id:
          type: integer
        title:
          type: string
        status:
          type: string
    MeetingWithMomResponseDto:
      type: object
      properties:
        id:
          type: integer
        title:
          type: string
        meetingdate:
          type: string
        momId:
          type: integer
        momText:
          type: string
    DashBoardResponseDto:
      type: object
      properties:
        totalTasks:
          type: integer
        doneTasks:
          type: integer
        inProgressTasks:
          type: integer
        notStartedTasks:
          type: integer
        overallprogress:
          type: number
          format: double